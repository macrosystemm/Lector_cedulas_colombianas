<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Lector PDF417 Cédula</title>
  <!-- Importa la librería ZXing desde un CDN -->
  <script src="https://unpkg.com/@zxing/library@latest"></script>
</head>
<body>
  <h1>Escanear Cédula Colombiana (PDF417)</h1>

  <!-- Video para mostrar la cámara -->
  <video id="video" width="400" height="300" autoplay></video>
  <p id="resultado">Esperando escaneo...</p>

  <script>
    // Crear el lector PDF417
    const codeReader = new ZXing.BrowserPDF417Reader();
    const videoElement = document.getElementById('video');
    const resultado = document.getElementById('resultado');

    // Abrir la cámara
    navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } })
      .then(stream => {
        videoElement.srcObject = stream;
        videoElement.play();

        // Escanear continuamente
        codeReader.decodeFromVideoDevice(null, videoElement, (result, err) => {
          if (result) {
            resultado.textContent = "Datos decodificados: " + result.getText();
          }
          if (err && !(err instanceof ZXing.NotFoundException)) {
            console.error(err);
          }
        });
      })
      .catch(err => {
        console.error("Error al acceder a la cámara: ", err);
        resultado.textContent = "No se pudo abrir la cámara.";
      });
  </script>
</body>
</html>
